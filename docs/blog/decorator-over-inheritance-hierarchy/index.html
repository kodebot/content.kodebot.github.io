<!DOCTYPE html>
<html lang="en-gb"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="generator" content="Hugo 0.54.0" />
	
	<title>Decorator over Inheritance hierarchy | kodebot</title>
	
	
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
	 crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
	<link href="/kodebot/blog/css/medium.css" rel="stylesheet">
	<link href="/kodebot/blog/css/additional.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
    <div class="container pr-0">
        
        <a class="navbar-brand" href="http://localhost/kodebot/blog//">

            
            <span style="font-family:Righteous;">kodebot</span>
            
        </a>
        

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        <div class="collapse navbar-collapse" id="navbarMediumish">
            
            <ul class="navbar-nav ml-auto">
                
            </ul>
        </div>
        
    </div>
</nav>


        <div class="site-content">   
            <div class="container">
<div class="mainheading">
    <h1 class="sitetitle">kodebot</h1>
    <p class="lead">
         
    </p>
</div><div class="main-content">
        
        <div class="container">
            <div class="row">
                
                <div class="col-md-2 pl-0"><div class="share">
    <p>Share</p>
    <ul>
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://twitter.com/intent/tweet?text=Decorator%20over%20Inheritance%20hierarchy&url=http%3a%2f%2flocalhost%2fkodebot%2fblog%2fdecorator-over-inheritance-hierarchy%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
        <i class="fab fa-twitter"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://facebook.com/sharer.php?u=http%3a%2f%2flocalhost%2fkodebot%2fblog%2fdecorator-over-inheritance-hierarchy%2f" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
        <i class="fab fa-facebook-f"></i>
        </a>
        </li>
        
        <li class="ml-1 mr-1">
        <a target="_blank" href="https://plus.google.com/share?url=http%3a%2f%2flocalhost%2fkodebot%2fblog%2fdecorator-over-inheritance-hierarchy%2f" onclick="window.open(this.href, 'google-share', 'width=550,height=435');return false;">
        <i class="fab fa-google"></i>
        </a>
        </li>

        <li class="ml-1 mr-1">
        <a target="_blank" href="https://www.xing.com/spi/shares/new?url=http%3a%2f%2flocalhost%2fkodebot%2fblog%2fdecorator-over-inheritance-hierarchy%2f" onclick="window.open(this.href, 'xing-share', 'width=550,height=435');return false;">
        <i class="fab fa-xing"></i>
        </a>
        </li>        
    </ul>

    
        <div class="sep">
        </div>				
        <ul>
            <li> 
            <a  class="small smoothscroll" href="#disqus_thread"></a>
            </li>
        </ul>
    
</div></div>
                                
                <div class="col-md-9 flex-first flex-md-unordered">
                    <div class="mainheading">
                        	
                                                
                        
                        <h1 class="posttitle">Decorator over Inheritance hierarchy</h1> 
                    </div>

                    
                    
                    
                    
                    
                    <div class="article-post">
                        <p>I have used inheritance to solve a problem in many situations - some of them are correct and some of them are not when thinking about it now.</p>
<div>
<p>When you are in a situation where you think you need multi-level inheritance, 9 out of 10 times you can solve the same problem using decorators.</p>
</div><!-- more -->
<div>
<p>One of the problems I have seen recently which fits in this pattern is the implementation of ICommand interface. See the implementation below</p>

<pre><code class="language-lang:csharp">public class Command : ICommand
   {  
     public bool CanExecute(object parameter)  
     {  
       // normal can execute version  
       return true;  
     }  

     public event EventHandler CanExecuteChanged;  

     public void Execute(object parameter)  
     {  
       // normal execute version  
     }  
   }  

   public class AuditedCommand:Command  
   {  
     public bool CanExecute(object parameter)  
     {  
       // audited can execute version  
       return base.CanExecute(parameter);  
     }  

     public void Execute(object parameter)  
     {  
       // audited execute version  
       base.Execute(parameter);  
     }  
   }  

   public class SecureCommand : Command  
   {  
     public bool CanExecute(object parameter)  
     {  
       // Secure can execute version  
       return base.CanExecute(parameter);  
     }  

     public void Execute(object parameter)  
     {  
       // Secure execute version  
       base.Execute(parameter);  
     }  
   }  
</code></pre>

<p>In this example, Command class is implementing ICommand interface and it provides basic version of the Command. Two other classes AuditedCommand and SecureCommand are inherited from Command to add some additional behaviours.</p>
<p>What do we do if we need a Command which supports Auditing and Security? There are two ways we can solve this problem using inheritance&nbsp;</p>
<ol>
<li>Use multi-level inheritance where SecureCommand inherits from AuditedCommand and AuditedCommand from Command</li>
<li>Create a new class SecureAuditedCommand which inherits from &nbsp;Command</li>
</ol>
<div>
<p>If we use the first approach we loose the flexibility to use just SecureCommand without going through AuditedCommand. Approach 2 is not really sustainable because we cannot create new classes for every combination of new command behaviours we might need in the future.</p>
</div>
<div>
<p>Another problem with approach 2 is it violates <a href="http://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank">SRP</a>.</p>
</div>
<div>
<p>So, what is the better way to solve this problem and keep our code maintainable.</p>
</div>
<div>
<p>The one word answer is "Decorator".</p>
</div>
<div>
<p>Here is how it looks like with Decorator pattern</p>

<pre><code class="language-lang:csharp">public class Command : ICommand  
   {  
     public bool CanExecute(object parameter)  
     {  
       // normal can execute  
       return true;  
     }  

     public event EventHandler CanExecuteChanged;  

     public void Execute(object parameter)  
     {  
       // normal execute  
     }  
   }  

   public abstract class CommandDecorator : ICommand  
   {  
     private ICommand _command;  

     public CommandDecorator(ICommand command)  
     {  
       this._command = command;  
     }  

     public virtual bool CanExecute(object parameter)  
     {  
       return _command.CanExecute(parameter);  
     }  

    // should be a wrapper to the property in the base class
     public event EventHandler CanExecuteChanged; 

     public virtual void Execute(object parameter)  
     {  
       _command.Execute(parameter);  
     }  
   }  

   public class AuditedCommand:CommandDecorator  
   {  
     public AuditedCommand(ICommand command):base(command)  
     {  
     }  

     public override bool CanExecute(object parameter)  
     {  
       // Audit behaviour goes here  
       return base.CanExecute(parameter);  
     }  

     public override void Execute(object parameter)  
     {  
       // Audit behaviour goes here  
       base.Execute(parameter);  
     }  

   }  

   public class SecureCommand : CommandDecorator  
   {  
     public SecureCommand(ICommand command):base(command)  
     {  
     }  

     public override bool CanExecute(object parameter)  
     {  
       // Secure behaviour goes here  
       return base.CanExecute(parameter);  
     }  

     public override void Execute(object parameter)  
     {  
       // Secure behaviour goes here  
       base.Execute(parameter);  
     }  
   }  

       // Here is how you compose your commands
       ICommand auditedDecorator = new AuditedCommand(command);  
       ICommand secureDecorator = new SecureCommand(command);  
       ICommand auditedSecureDecorator = new SecureCommand(auditedDecorator);

</code></pre>

<p><p>Now, we can compose any type of command without compromising maintainability.</p>
</div>
</div></p>

                    </div>
                    
                    
                    <div class="after-post-tags">
                        <ul class="tags">
                        
                        <li>
                        <a href="/kodebot/blog/tags/design-pattern">Design Pattern</a>
                        </li>
                        
                        <li>
                        <a href="/kodebot/blog/tags/c">C#</a>
                        </li>
                        
                        </ul>
                    </div>
                    
                    
                    
                    <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
                    
                    
                        <a class="d-block col-md-6 text-lg-right" href="/kodebot/blog/setup-chutzpah-to-run-javascript-tests-in-visualstudio/">Setup Chutzpah to Run Javascript Tests in VisualStudio &raquo;</a>
                    
                    <div class="clearfix"></div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        
<div class="container">
    <div id="comments" class="row justify-content-center mb-5">
        <div class="col-md-8">              
                           
        </div>
    </div>
</div>

    </div>
<div class="alertbar">
	<div class="container text-center">
        <span>
            
                <span style="font-family:Righteous;">kodebot</span>
            
            &nbsp; Never miss a <b>story</b>, subscribe to our newsletter
        </span>

        <form action="" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate>
		<input type="email" placeholder="Email" name="EMAIL" autocomplete="on" required>
	    	
	    	<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="" tabindex="-1" value=""></div>
		<input type="submit" value="Subscribe" name="subscribe" >
        </form>

	</div>
</div> 

            </div>
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
			<div class="d-md-flex align-items-center justify-content-center h-100">
				<h2 class="d-md-block d-none align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
			</div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
			
			<a href="/kodebot/blog/tags/c">c#</a>
			
			<a href="/kodebot/blog/tags/design-pattern">design-pattern</a>
			
			<a href="/kodebot/blog/tags/javascript">javascript</a>
			
			<a href="/kodebot/blog/tags/unit-testing">unit-testing</a>
			
			<a href="/kodebot/blog/tags/visual-studio">visual-studio</a>
			
		</div>
	</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                &copy; Copyright 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net">Mediumish Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>

        </div>

    
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>    
    
<script src="/kodebot/blog/js/mediumish.js"></script>

    </body>
</html>
